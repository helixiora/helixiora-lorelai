{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    {% if user is none %}
        <div class="alert alert-danger" role="alert">
            <h4 class="alert-heading">Unauthorized Access!</h4>
            <p>You are not authorized to access this page. Please <a href="/login" class="alert-link">login</a> to access this page.</p>
        </div>
    {% else %}
        <div class="card mb-2 mt-2" id="card-welcome">
            <h5 class="card-header h5">Welcome, {{ user.full_name }}!</h5>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Full Name:</strong> {{ user.full_name }}</li>
                    <li class="list-group-item"><strong>Username:</strong> {{ user.username }}</li>
                    <li class="list-group-item"><strong>Email:</strong> {{ user.email }}</li>
                    <li class="list-group-item"><strong>Organisation:</strong> {{ user.organisation }}</li>
                    <li class="list-group-item"><strong>Role:</strong> {{ user.roles }}</li>
                </ul>
            </div>
        </div>

        <!-- Include Indexer -->
        {% include 'sections/indexer.html' %}

        <!-- Marketplace Integration Section -->
        <div class="card mb-2 mt-2" id="card-integrations">
            <h5 class="h5 card-header">Integrations</h5>
            <div class="card-body">
            {% if features.google_drive %}
                {% include 'integrations/profile-google.html' %}
            {% else %}
                <p>Google Drive is not available in this environment.</p>
            {% endif %}

            {% if features.slack %}
                {% include 'integrations/profile-slack.html' %}
            {% else %}
                <p>Slack is not available in this environment.</p>
            {% endif %}
        </div>
    {% endif %}
</div>

<script src="{{ url_for('serve_js', script_name='tour-profile') }}"></script>

{% endblock %}
